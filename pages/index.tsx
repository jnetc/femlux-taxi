import type { NextPage, GetStaticProps, InferGetStaticPropsType } from 'next';
import Head from 'next/head';
import { request, query } from 'lib/datocms';
import { Button } from '@Components/Button';
// Context
import { ContentStore } from '@Store/contentStore';
import { extraCSS } from '@Helpers/critical';
// Components
import Navigation from '@Components/navigation/Navigation';

// import { Provider, atom, useAtom } from 'jotai';
// import { increaseNumber, withString } from '@Hooks/useJotai';

// import { JotaiBtn } from '@Components/JotaiBtn';
// import { JotaiValue } from '@Components/JotaiValue';

import { useStore } from '@Hooks/useZustand';
import { useEffect } from 'react';

interface Intro<T> {
  title: T;
  subtitle: T;
  id: T;
}
interface Navigation<T> {
  navigation: Array<{ link: T }>;
}
interface Data {
  intro: Intro<string>;
  nav: Navigation<string>;
}

const Home: NextPage = ({
  data,
  lang,
}: InferGetStaticPropsType<typeof getStaticProps>) => {
  // console.log(lang);
  const { switchLang } = useStore();
  useEffect(() => {
    switchLang(lang);
  }, [switchLang, lang]);

  return (
    // <Provider>
    // <ContentStore.Provider value={{ content: '', setContent: () => '' }}>
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
        <style dangerouslySetInnerHTML={{ __html: extraCSS }} />
      </Head>

      <Navigation />

      <main>
        <Button />
        {/* <JotaiBtn />
        <JotaiValue /> */}
      </main>
      <footer>Footer</footer>
    </>
    // </ContentStore.Provider>
    // </Provider>
  );
};

export default Home;

export const getStaticProps: GetStaticProps = async context => {
  console.log(context);

  // const data = await request({ query, variables: { locale: context.locale } });
  const data = null;
  console.log('__DATOCMS', data);

  return {
    props: { data, lang: context.locale },
  };
};
